on:
  pull_request:
jobs:
  validate-keywords:
    runs-on: ubuntu-latest
    steps:
      - uses: step-security/harden-runner@91182cccc01eb5e619899d80e4e971d6181294a7 # v2.10.1
        with:
          egress-policy: audit

      - uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4

      - id: validate
        uses: actions-tools/yaml-outputs@v2.1 # v2.1
        with:
          file-path: "**/metadata.yaml"
        strategy:
          fail-fast: false
          matrix:
            keywords: ${{ steps.validate.outputs.keywords }}
            allowed: [application, base, fips, ai, ai-gpu, stigs]
        steps:
          - if: ${{ !contains(matrix.keywords, matrix.allowed) }}
            run: echo "Included keyword not in allowed list. Please remove."
